from pwn import *
from binascii import unhexlify

HOST = '74.225.222.43'
PORT = 5000

io = remote(HOST,PORT)

io.recvuntil(b"response: ")

payload = '0'*32*2

io.sendline('3')
io.sendline(payload)
io.recvuntil(b"(hex): ")

inv=eval(io.recvuntil(b"}"))
s = inv["error"].replace("Invalid plaintext: ","")

ct1,ct2 = unhexlify(s[:32]),unhexlify(s[32:])

key = xor(ct1,ct2).hex()

io.recvuntil(b"response: ")
io.sendline("2")
io.recvuntil(b"(hex): ")
io.sendline(key)
io.recvline()

flag = unhexlify(eval(io.recvline())['plaintext'])
print(flag.decode())

